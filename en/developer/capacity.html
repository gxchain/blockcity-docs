<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>开放能力 | The Small Application</title>
    <meta name="description" content="The Small Application is based on the BlockCity DAPP, helping developers to quickly develop and launch their own applications, serving the massive blockchain users of BlockCity.">
    
    
    <link rel="preload" href="/blockcity/assets/css/0.styles.b7926cab.css" as="style"><link rel="preload" href="/blockcity/assets/js/app.dd063d02.js" as="script"><link rel="preload" href="/blockcity/assets/js/16.682216e4.js" as="script"><link rel="prefetch" href="/blockcity/assets/js/10.33a9ca4b.js"><link rel="prefetch" href="/blockcity/assets/js/11.6e12906d.js"><link rel="prefetch" href="/blockcity/assets/js/12.92166a06.js"><link rel="prefetch" href="/blockcity/assets/js/13.d619c38b.js"><link rel="prefetch" href="/blockcity/assets/js/14.c6852a6e.js"><link rel="prefetch" href="/blockcity/assets/js/15.b18846f1.js"><link rel="prefetch" href="/blockcity/assets/js/17.261a2ee9.js"><link rel="prefetch" href="/blockcity/assets/js/18.768c0c10.js"><link rel="prefetch" href="/blockcity/assets/js/19.c7b0306f.js"><link rel="prefetch" href="/blockcity/assets/js/20.e28b8d88.js"><link rel="prefetch" href="/blockcity/assets/js/21.c7146780.js"><link rel="prefetch" href="/blockcity/assets/js/22.c87b9420.js"><link rel="prefetch" href="/blockcity/assets/js/23.99ca732a.js"><link rel="prefetch" href="/blockcity/assets/js/24.0e0a396c.js"><link rel="prefetch" href="/blockcity/assets/js/25.0fb7da64.js"><link rel="prefetch" href="/blockcity/assets/js/26.c0b8b8ad.js"><link rel="prefetch" href="/blockcity/assets/js/27.a0355dd3.js"><link rel="prefetch" href="/blockcity/assets/js/28.e142bc61.js"><link rel="prefetch" href="/blockcity/assets/js/29.af9a52ec.js"><link rel="prefetch" href="/blockcity/assets/js/3.859a4d47.js"><link rel="prefetch" href="/blockcity/assets/js/30.7da6b7b5.js"><link rel="prefetch" href="/blockcity/assets/js/31.c26a9311.js"><link rel="prefetch" href="/blockcity/assets/js/32.f425157e.js"><link rel="prefetch" href="/blockcity/assets/js/33.ea878810.js"><link rel="prefetch" href="/blockcity/assets/js/34.e08feb9c.js"><link rel="prefetch" href="/blockcity/assets/js/35.0eeabdfa.js"><link rel="prefetch" href="/blockcity/assets/js/36.3d4fc0af.js"><link rel="prefetch" href="/blockcity/assets/js/37.059882f7.js"><link rel="prefetch" href="/blockcity/assets/js/38.eea6d96d.js"><link rel="prefetch" href="/blockcity/assets/js/4.059e1459.js"><link rel="prefetch" href="/blockcity/assets/js/5.48244305.js"><link rel="prefetch" href="/blockcity/assets/js/6.44cfa878.js"><link rel="prefetch" href="/blockcity/assets/js/7.35e6b462.js"><link rel="prefetch" href="/blockcity/assets/js/8.0022d733.js"><link rel="prefetch" href="/blockcity/assets/js/9.ef3fd925.js"><link rel="prefetch" href="/blockcity/assets/js/vendors~docsearch.d932dc62.js">
    <link rel="stylesheet" href="/blockcity/assets/css/0.styles.b7926cab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blockcity/en/" class="home-link router-link-active"><!----> <span class="site-name">The Small Application</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blockcity/en/introduce/" class="nav-link">Introduce</a></div><div class="nav-item"><a href="/blockcity/en/developer/" class="nav-link router-link-active">Developer</a></div><div class="nav-item"><a href="/blockcity/en/design/" class="nav-link">Design</a></div><div class="nav-item"><a href="/blockcity/en/operation/" class="nav-link">Operation</a></div><div class="nav-item"><a href="/blockcity/en/faq/" class="nav-link">FAQ</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blockcity/developer/capacity.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/blockcity/en/developer/capacity.html" class="nav-link router-link-exact-active router-link-active">English</a></li></ul></div></div> <a href="https://github.com/gxchain/blockcity-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blockcity/en/introduce/" class="nav-link">Introduce</a></div><div class="nav-item"><a href="/blockcity/en/developer/" class="nav-link router-link-active">Developer</a></div><div class="nav-item"><a href="/blockcity/en/design/" class="nav-link">Design</a></div><div class="nav-item"><a href="/blockcity/en/operation/" class="nav-link">Operation</a></div><div class="nav-item"><a href="/blockcity/en/faq/" class="nav-link">FAQ</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blockcity/developer/capacity.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/blockcity/en/developer/capacity.html" class="nav-link router-link-exact-active router-link-active">English</a></li></ul></div></div> <a href="https://github.com/gxchain/blockcity-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blockcity/en/developer/" class="sidebar-link">开发者入驻</a></li><li><a href="/blockcity/en/developer/create.html" class="sidebar-link">创建小应用</a></li><li><a href="/blockcity/en/developer/prepare.html" class="sidebar-link">小应用开发准备</a></li><li><a href="/blockcity/en/developer/release.html" class="sidebar-link">小应用提交</a></li><li><a href="/blockcity/en/developer/capacity.html" class="active sidebar-link">开放能力</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#gid授权" class="sidebar-link">GID授权</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#功能介绍" class="sidebar-link">功能介绍</a></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#接入指引" class="sidebar-link">接入指引</a></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#数据api列表" class="sidebar-link">数据API列表</a></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#补充说明" class="sidebar-link">补充说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#blockpay支付" class="sidebar-link">BlockPay支付</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#功能介绍-2" class="sidebar-link">功能介绍</a></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#接入指引-2" class="sidebar-link">接入指引</a></li></ul></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#小应用关闭" class="sidebar-link">小应用关闭</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#功能介绍-3" class="sidebar-link">功能介绍</a></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#接入指引-3" class="sidebar-link">接入指引</a></li></ul></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#扫一扫" class="sidebar-link">扫一扫</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#功能介绍-4" class="sidebar-link">功能介绍</a></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#接入指引-4" class="sidebar-link">接入指引</a></li></ul></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#自定义分享" class="sidebar-link">自定义分享</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#功能介绍-5" class="sidebar-link">功能介绍</a></li><li class="sidebar-sub-header"><a href="/blockcity/en/developer/capacity.html#接入指引-5" class="sidebar-link">接入指引</a></li></ul></li></ul></li><li><a href="/blockcity/en/developer/api.html" class="sidebar-link">API列表</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="开放能力"><a href="#开放能力" aria-hidden="true" class="header-anchor">#</a> 开放能力</h1> <h2 id="gid授权"><a href="#gid授权" aria-hidden="true" class="header-anchor">#</a> GID授权</h2> <h3 id="功能介绍"><a href="#功能介绍" aria-hidden="true" class="header-anchor">#</a> 功能介绍</h3> <p>开发者可以通过国际标准的OAuth2.0授权机制，在用户授权的情况下，得到用于换取用户信息的令牌。在拿到用户的授权令牌后，获取用户允许授权访问的数据内容。目前暂时只开放布洛克城用户基本信息接口，之后将会集成开发链上GID数据的本地DataKey解密并授权。</p> <h4 id="_1-1-应用场景"><a href="#_1-1-应用场景" aria-hidden="true" class="header-anchor">#</a> 1.1 应用场景</h4> <p>BlockPay支付</p> <h4 id="获取基本信息"><a href="#获取基本信息" aria-hidden="true" class="header-anchor">#</a> 获取基本信息</h4> <p>开发者除了可以拿到布洛克用户唯一编号（uuid）进行免登处理，还能获取更多的信息，包括昵称，居民号、是否是创世居民、注册时间、是否通过二要素实名认证、是否通过KYC实名认证、布洛克城头像。
此种场景，用户在操作过程中，会出现弹框界面（如下图）让用户确认是否授权。</p> <p><img src="/blockcity/img/d-5-1.png" alt="img"></p> <h4 id="_1-2-准入条件"><a href="#_1-2-准入条件" aria-hidden="true" class="header-anchor">#</a> 1.2 准入条件</h4> <p>小应用开发者均可使用。</p> <h4 id="_1-3-计费模式"><a href="#_1-3-计费模式" aria-hidden="true" class="header-anchor">#</a> 1.3 计费模式</h4> <p>暂不收费</p> <h3 id="接入指引"><a href="#接入指引" aria-hidden="true" class="header-anchor">#</a> 接入指引</h3> <h4 id="_2-1-开发准备"><a href="#_2-1-开发准备" aria-hidden="true" class="header-anchor">#</a> 2.1 开发准备</h4> <h4 id="获取小应用appid"><a href="#获取小应用appid" aria-hidden="true" class="header-anchor">#</a> 获取小应用APPID</h4> <p>登录布洛克城开放平台，进入小应用列表，点击详情分别获取获取沙箱环境和正式环境的AppID和AppSecret。</p> <p><img src="/blockcity/img/d-3-3.png" alt="img"></p> <h4 id="_2-2-技术接入"><a href="#_2-2-技术接入" aria-hidden="true" class="header-anchor">#</a> 2.2 技术接入</h4> <h4 id="_2-2-1-oauth2-0授权流程图"><a href="#_2-2-1-oauth2-0授权流程图" aria-hidden="true" class="header-anchor">#</a> 2.2.1 Oauth2.0授权流程图</h4> <p><img src="/blockcity/img/d-5-2.png" alt="img"></p> <h4 id="_2-2-2-主流程说明"><a href="#_2-2-2-主流程说明" aria-hidden="true" class="header-anchor">#</a> 2.2.2 主流程说明</h4> <p><strong>第一步：登录状态检测</strong></p> <p>对于需要用户授权的小应用，每当用户进入小应用时，需要先判断当前用户的登录状态，决定是否需要对当前用户进行GID授权。</p> <p><strong>第二步：小应用获取授权code</strong></p> <p>当小应用需要授权时，小应用client控制页面访问布洛克城授权页面：</p> <div class="language- extra-class"><pre class="language-text"><code>沙箱环境地址：https://sandbox.blockcity.gxb.io/#/oauth/authorize?response_type=code&amp;client_id=&amp;redirect_uri=https%3A%2F%2Fxxx&amp;state=

正式环境地址：https://blockcity.gxb.io/#/oauth/authorize?response_type=code&amp;client_id=&amp;redirect_uri=https%3A%2F%2Fxxx&amp;state=
</code></pre></div><p>参数说明：</p> <table><thead><tr><th style="text-align:left">字段</th> <th style="text-align:left">是否必选</th> <th style="text-align:left">描述</th></tr></thead> <tbody><tr><td style="text-align:left">response_type</td> <td style="text-align:left">是</td> <td style="text-align:left">授权类型 ，值为code</td></tr> <tr><td style="text-align:left">client_id</td> <td style="text-align:left">是</td> <td style="text-align:left">等同于appid，创建应用时获得</td></tr> <tr><td style="text-align:left">redirect_uri</td> <td style="text-align:left">是</td> <td style="text-align:left">回调地址，在用户授权后应用会跳转至redirect_uri，<strong>务必对地址进行urlencode。</strong></td></tr> <tr><td style="text-align:left">state</td> <td style="text-align:left">否</td> <td style="text-align:left">维持应用的状态，传入值与返回值保持一致</td></tr></tbody></table> <p>获取授权code：</p> <p>当用户点击确认授权后，网页会重定向到回调地址，应用从回调地址中获取code。回调请求如下：</p> <div class="language- extra-class"><pre class="language-text"><code>https://xxx?code=124124&amp;state=
</code></pre></div><p><strong>第三步：小应用服务端获取access_token</strong></p> <ul><li><p>开发者可通过获取到的授权code换取access_token，授权code作为换取access_token的票据，每次用户授权完成，回调地址中的授权code将不一样，授权code只能使用一次，一天未被使用自动过期。具体可参见文档<a href="/blockcity/en/developer/api.html#获取令牌api">获取令牌API</a>。</p></li> <li><p>每个access_token目前有效期为30天，可调用refresh接口刷新时长，再次刷新有效期为30天，只能刷新一次。具体可参见文档<a href="/blockcity/en/developer/api.html#刷新令牌api">刷新令牌API</a>。</p></li></ul> <p><strong>第四步：小应用服务端签名获取GID信息</strong></p> <ul><li>获取access_token后为了防止API调用过程中被黑客恶意篡改，调用任何一个API都需要携带签名，服务端会根据请求参数，对签名进行验证，签名不合法的请求将会被拒绝。根据实际授权范围，选择对应的数据API进行访问获取GID相关信息，比如<a href="/blockcity/en/developer/api.html#user-baseinfo（用户基本信息api）">用户基本信息API</a>。</li></ul> <p><strong>第五步：小应用客户端保存登录信息</strong></p> <ul><li>用户授权完成后，需要在小应用客户端维护这个用户的登录状态,可以<strong>存localstorage</strong>能保持更长的登录状态，不要存cookie，容易丢失，当登录状态失效时需触发重新授权。</li> <li>access_token的有效期为30天，刷新再延长30天，当access_token失效时，请重新授权。</li> <li>另外当用户登出布洛克城时，布洛克城会失效用户对应用的授权access_token，所以判断localstorage的登录信息的同时，查询用户基本信息接口验证access_token有效性。避免用户登出后换个手机号登录，应用内的登录状态还是之前一个账号的情况。</li></ul> <h3 id="数据api列表"><a href="#数据api列表" aria-hidden="true" class="header-anchor">#</a> 数据API列表</h3> <table><thead><tr><th style="text-align:left">接口名称</th> <th style="text-align:left">描述</th></tr></thead> <tbody><tr><td style="text-align:left"><a href="/blockcity/en/developer/api.html#user-baseinfo（用户基本信息api）">用户基本信息API</a></td> <td style="text-align:left">小应用服务端获取用户基本信息</td></tr></tbody></table> <blockquote><p><font size="2"><em>其他数据接口将陆续开放。</em></font></p></blockquote> <h3 id="补充说明"><a href="#补充说明" aria-hidden="true" class="header-anchor">#</a> 补充说明</h3> <ul><li>涉及到敏感信息如真实姓名、手机号、证件号等，这些敏感信息不会返回。</li> <li>上链数据授权会陆续开放，同样遵循GID授权流程。</li> <li><a href="/blockcity/en/developer/api.html#获取令牌api">令牌签名</a></li></ul> <h2 id="blockpay支付"><a href="#blockpay支付" aria-hidden="true" class="header-anchor">#</a> BlockPay支付</h2> <h3 id="功能介绍-2"><a href="#功能介绍-2" aria-hidden="true" class="header-anchor">#</a> 功能介绍</h3> <p>BlockPay支付是一个基于布洛克城账户，资金，支付体系，支持包括GXS，BTC，ETH等主流虚拟货币的全币种支付手段。能帮助小应用开发者完成支付，转账，退款，对账等一列表操作。</p> <h4 id="_1-1-功能流程"><a href="#_1-1-功能流程" aria-hidden="true" class="header-anchor">#</a> 1.1 功能流程</h4> <p>步骤1：用户在小应用中选择商品下单、确认购买，进入支付环节，用户点击确认支付；</p> <p><img src="/blockcity/img/d-5-3.png" alt="img"> <img src="/blockcity/img/d-5-4.png" alt="img"></p> <p>步骤2：进入到布洛克城页面，调起BlockPay支付，出现确认支付界面；</p> <p><img src="/blockcity/img/d-5-5.png" alt="img"></p> <p>步骤3：用户确认收款方和金额，点击立即支付后出现输入密码界面；</p> <p><img src="/blockcity/img/d-5-6.png" alt="img"> <img src="/blockcity/img/d-5-7.png" alt="img"></p> <p>步骤4：输入正确密码后，BlockPay端显示支付结果；</p> <p><img src="/blockcity/img/d-5-8.png" alt="img"></p> <p>步骤5：自动回跳到小应用中。</p> <h4 id="_1-2-准入条件-2"><a href="#_1-2-准入条件-2" aria-hidden="true" class="header-anchor">#</a> 1.2 准入条件</h4> <p>该产品使用者需要实名开发者，且个人开发者有日收款限额。</p> <h4 id="_1-3-计费模式-2"><a href="#_1-3-计费模式-2" aria-hidden="true" class="header-anchor">#</a> 1.3 计费模式</h4> <p>暂不收费</p> <h3 id="接入指引-2"><a href="#接入指引-2" aria-hidden="true" class="header-anchor">#</a> 接入指引</h3> <h4 id="_2-1-开发准备-2"><a href="#_2-1-开发准备-2" aria-hidden="true" class="header-anchor">#</a> 2.1 开发准备</h4> <h4 id="_2-1-1-获取小应用appid"><a href="#_2-1-1-获取小应用appid" aria-hidden="true" class="header-anchor">#</a> 2.1.1 获取小应用APPID</h4> <p>登录布洛克城开放平台，进入小应用列表，点击详情分别获取获取沙箱环境和正式环境的AppID和AppSecret。</p> <p><img src="/blockcity/img/d-3-3.png" alt="img"></p> <h4 id="_2-1-2-上传应用公钥"><a href="#_2-1-2-上传应用公钥" aria-hidden="true" class="header-anchor">#</a> 2.1.2 上传应用公钥</h4> <p>开发者需创建一对RSA公私钥，公钥上传给布洛克城开放平台，在小应用服务端用私钥加密签名生成sign，作为支付接口必要请求参数。生成公私钥对可使用<a href="http://web.chacuo.net/netrsakeypair" target="_blank" rel="noopener noreferrer">RSA生成工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，设置密钥位数为2048位，秘钥格式为PKCS#8,证书密码不用设置</p> <p><img src="/blockcity/img/d-3-5.png" alt="img"></p> <p>上传公钥格式，不要带上“-----BEGIN PUBLIC KEY-----”和“-----END PUBLIC KEY-----”</p> <div class="language-java extra-class"><pre class="language-java"><code>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAm8MBCBTrNJWGyyA9W7aW
juY6j<span class="token operator">/</span>APar4ZCkGkuJCU6TdRiYgeE4X1pU<span class="token operator">+</span>V8KV1j2xDmO3aaUSx8Qwrofmue3QK
Cx8PD3e6Bgw<span class="token operator">/</span>IjDBIgfOXp1wygTzfFLWu<span class="token operator">+</span>l2jXs1JBV6jvekCjT7luZQrB9hSTgg
<span class="token number">1</span>tZ44<span class="token operator">+</span>ZQFkilRdwdsL1t9ajeAYa61YoYyCe<span class="token operator">/</span>nitLJqAXfwlvKrVyaot8q8cd<span class="token operator">/</span>f0X
<span class="token number">26</span>SxWtro3hLHvuyTmsu<span class="token operator">+</span>ihmbotWw64bBI9dmklGziHJXThNr<span class="token operator">+</span>pyjzKgSz4fzMdyl
uATOTMpL2j0U6sFlI1hfhvNMKuHOaIYniP4zFEPs<span class="token operator">/</span><span class="token number">5</span>tw5fZrHMVnGn6V8LFj5kDP
BQIDAQAB
</code></pre></div><h4 id="_2-1-3-引入blockcity-js-sdk"><a href="#_2-1-3-引入blockcity-js-sdk" aria-hidden="true" class="header-anchor">#</a> 2.1.3 引入Blockcity JS-SDK</h4> <h4 id="cdn引入"><a href="#cdn引入" aria-hidden="true" class="header-anchor">#</a> CDN引入</h4> <p>通过 <a href="https://unpkg.com/blockcity-js-sdk/" target="_blank" rel="noopener noreferrer">unpkg.com/blockcity-js-sdk<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 可以看到 Blockcity JS-SDK 最新版本的资源，也可以切换版本选择需要的资源，在页面上引入 js 文件即可开始使用：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;//unpkg.com/blockcity-js-sdk/dist/blockcity-js-sdk.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h4 id="npm安装"><a href="#npm安装" aria-hidden="true" class="header-anchor">#</a> NPM安装</h4> <p>推荐使用 npm 来安装，享受生态圈和工具带来的便利，更好地和 webpack 配合使用。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> blockcity-js-sdk -save
</code></pre></div><p>npm使用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> BlockCity <span class="token keyword">from</span> <span class="token string">'blockcity-js-sdk'</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-接入blockpay支付"><a href="#_2-2-接入blockpay支付" aria-hidden="true" class="header-anchor">#</a> 2.2 接入BlockPay支付</h4> <h4 id="blockpay支付调用流程图"><a href="#blockpay支付调用流程图" aria-hidden="true" class="header-anchor">#</a> BlockPay支付调用流程图</h4> <p><img src="/blockcity/img/d-5-9.jpg" alt="img"></p> <h4 id="主要步骤"><a href="#主要步骤" aria-hidden="true" class="header-anchor">#</a> 主要步骤</h4> <p><strong>第一步：发起支付</strong></p> <p>用户在小应用客户端触发支付流程。</p> <p><strong>第二步：预创建支付</strong></p> <p>在小应用服务端把生成相关的支付信息，调用<a href="/blockcity/en/developer/api.html#blockpay-trade-app-pay（预创建支付api）">预创建支付接口 </a>, 获取trade_no。</p> <p><strong>第三步：唤起收银台</strong></p> <p>小应用使用trade_no，唤起布洛克城BlockPay收银台。用户输入密码进行支付，支持成功，失败，取消都会有对应的js回调，小应用客户端可以分别对这些操作做出响应。在支付完成（成功或取消）后，收银台会隐藏页面并返回之前唤起收银台的页面。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>BlockCity<span class="token punctuation">.</span><span class="token function">choosePay</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    tradeNo<span class="token punctuation">:</span> <span class="token string">''</span>
    success<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'支付成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    fail<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'支付失败：'</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    cancel<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'取消支付'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p><font size="2">小应用需要先引入Blockcity JS-SDK</font></p></blockquote> <p><strong>第四步：支付回调</strong></p> <p>用户支付成功后，小应用服务端会收到来自布洛克城的支付结果回调，回调地址为调用<a href="/blockcity/en/developer/api.html#blockpay-trade-app-pay（预创建支付api）">预创建支付接口</a> 时，指定的notify_url，回调接口请求方式为 JSON POST BODY。</p> <ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:left">参数</th> <th style="text-align:left">类型</th> <th style="text-align:left">是否必须</th> <th style="text-align:left">描述</th></tr></thead> <tbody><tr><td style="text-align:left">appId</td> <td style="text-align:left">string</td> <td style="text-align:left">是</td> <td style="text-align:left">应用id</td></tr> <tr><td style="text-align:left">tradeNo</td> <td style="text-align:left">string</td> <td style="text-align:left">是</td> <td style="text-align:left">支付订单号</td></tr> <tr><td style="text-align:left">outTradeNo</td> <td style="text-align:left">string</td> <td style="text-align:left">是</td> <td style="text-align:left">商户唯一订单号</td></tr> <tr><td style="text-align:left">paySuccess</td> <td style="text-align:left">boolean</td> <td style="text-align:left">是</td> <td style="text-align:left">是否支付成功</td></tr> <tr><td style="text-align:left">callbackParams</td> <td style="text-align:left">string</td> <td style="text-align:left">否</td> <td style="text-align:left">预创建时商户传入的参数</td></tr> <tr><td style="text-align:left">sign</td> <td style="text-align:left">string</td> <td style="text-align:left">是</td> <td style="text-align:left">回调签名，签名方式：RSA(&quot;appId=&amp;outTradeNo=&amp;paySuccess=&amp;tradeNo=&quot;,&quot;公钥&quot;)</td></tr></tbody></table> <ul><li>校验签名示例</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>        PayCallBackParam param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PayCallBackParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        param<span class="token punctuation">.</span><span class="token function">setAppId</span><span class="token punctuation">(</span><span class="token string">&quot;appId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        param<span class="token punctuation">.</span><span class="token function">setOutTradeNo</span><span class="token punctuation">(</span><span class="token string">&quot;outTradeNo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        param<span class="token punctuation">.</span><span class="token function">setPaySuccess</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        param<span class="token punctuation">.</span><span class="token function">setTradeNo</span><span class="token punctuation">(</span><span class="token string">&quot;tradeNo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        param<span class="token punctuation">.</span><span class="token function">setSign</span><span class="token punctuation">(</span><span class="token string">&quot;回调签名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//组装签名体</span>
        StringBuilder builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;appId=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span><span class="token function">getAppId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;outTradeNo=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span><span class="token function">getOutTradeNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;paySuccess=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span><span class="token function">isPaySuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;tradeNo=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span><span class="token function">getTradeNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>RsaSignature<span class="token punctuation">.</span><span class="token function">rsaDecrypt</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span><span class="token function">getSign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;私钥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//签名通过</span>
        <span class="token punctuation">}</span>
</code></pre></div><ul><li>代码下载</li></ul> <p><a href="http://gxb-doc.oss-cn-hangzhou.aliyuncs.com/blockpay/paydemo.zip" target="_blank" rel="noopener noreferrer">JAVA代码示例下载<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>验证数据的正确性</li></ul> <p>在签名校验成功后，请严格校验：1.appId是否为改商户本身，2.outTradeNo为商户系统中创建的订单号，3.tradeNo能与outTradeNo对应。上述有任何一个验证不通过，则表明本次通知是异常通知</p> <ul><li>回调JSON请求示例：</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span><span class="token string">&quot;应用id&quot;</span>
    <span class="token property">&quot;tradeNo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;支付订单号&quot;</span>
    <span class="token property">&quot;outTradeNo&quot;</span><span class="token operator">:</span><span class="token string">&quot;商户唯一订单号&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;paySuccess&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;callbackParams&quot;</span><span class="token operator">:</span><span class="token string">&quot;根据预创建时传入的值一模一样返回&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sign&quot;</span><span class="token operator">:</span><span class="token string">&quot;返回签名&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>回调接口返回要求：</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;success&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="api列表"><a href="#api列表" aria-hidden="true" class="header-anchor">#</a> API列表</h4> <table><thead><tr><th style="text-align:left">接口名称</th> <th style="text-align:left">描述</th></tr></thead> <tbody><tr><td style="text-align:left"><a href="/blockcity/en/developer/api.html#预创建支付">预创建支付API</a></td> <td style="text-align:left">预先创建支付订单接口</td></tr> <tr><td style="text-align:left"><a href="/blockcity/en/developer/api.html#查询交易">查询交易API</a></td> <td style="text-align:left">交易状态主动查询接口</td></tr> <tr><td style="text-align:left"><a href="/blockcity/en/developer/api.html#退款接口">退款接口API</a></td> <td style="text-align:left">发起交易退款接口</td></tr> <tr><td style="text-align:left"><a href="/blockcity/en/developer/api.html#查询退款">查询退款API</a></td> <td style="text-align:left">交易退款状态查询接口</td></tr> <tr><td style="text-align:left"><a href="/blockcity/en/developer/api.html#关闭交易">关闭交易API</a></td> <td style="text-align:left">关闭指定的支付订单接口</td></tr> <tr><td style="text-align:left"><a href="/blockcity/en/developer/api.html#支持支付币种">支持支付币种API</a></td> <td style="text-align:left">拉取支持的所有支付币种接口</td></tr> <tr><td style="text-align:left"><a href="/blockcity/en/developer/api.html#转账ap">转账API</a></td> <td style="text-align:left">商户对用户进行直接转账的接口</td></tr></tbody></table> <h4 id="补充说明-2"><a href="#补充说明-2" aria-hidden="true" class="header-anchor">#</a> 补充说明</h4> <ul><li><a href="/blockcity/en/developer/api.html#支付签名">支付接口签名</a></li></ul> <h2 id="小应用关闭"><a href="#小应用关闭" aria-hidden="true" class="header-anchor">#</a> 小应用关闭</h2> <h3 id="功能介绍-3"><a href="#功能介绍-3" aria-hidden="true" class="header-anchor">#</a> 功能介绍</h3> <p>为开发者提供一键关闭本小应用的能力。</p> <h4 id="_1-1-功能流程-2"><a href="#_1-1-功能流程-2" aria-hidden="true" class="header-anchor">#</a> 1.1 功能流程</h4> <p>引入JS-SDK，直接调用即可</p> <h4 id="_1-2-准入条件-3"><a href="#_1-2-准入条件-3" aria-hidden="true" class="header-anchor">#</a> 1.2 准入条件</h4> <p>无</p> <h3 id="接入指引-3"><a href="#接入指引-3" aria-hidden="true" class="header-anchor">#</a> 接入指引</h3> <h4 id="_2-1-开发准备-3"><a href="#_2-1-开发准备-3" aria-hidden="true" class="header-anchor">#</a> 2.1 开发准备</h4> <h4 id="cdn引入-2"><a href="#cdn引入-2" aria-hidden="true" class="header-anchor">#</a> CDN引入</h4> <p>通过 <a href="https://unpkg.com/blockcity-js-sdk/" target="_blank" rel="noopener noreferrer">unpkg.com/blockcity-js-sdk<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 可以看到 Blockcity JS-SDK 最新版本的资源，也可以切换版本选择需要的资源，在页面上引入 js 文件即可开始使用：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;//unpkg.com/blockcity-js-sdk/dist/blockcity-js-sdk.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h4 id="npm安装-2"><a href="#npm安装-2" aria-hidden="true" class="header-anchor">#</a> NPM安装</h4> <p>推荐使用 npm 来安装，享受生态圈和工具带来的便利，更好地和 webpack 配合使用。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> blockcity-js-sdk -save
</code></pre></div><p>npm使用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> BlockCity <span class="token keyword">from</span> <span class="token string">'blockcity-js-sdk'</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-功能接入"><a href="#_2-2-功能接入" aria-hidden="true" class="header-anchor">#</a> 2.2 功能接入</h4> <p>给开发者能力直接退出当前的WebView。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>BlockCity<span class="token punctuation">.</span><span class="token function">closeWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><font size="2">小应用需要先引入Blockcity JS-SDK</font></p></blockquote> <h2 id="扫一扫"><a href="#扫一扫" aria-hidden="true" class="header-anchor">#</a> 扫一扫</h2> <h3 id="功能介绍-4"><a href="#功能介绍-4" aria-hidden="true" class="header-anchor">#</a> 功能介绍</h3> <p>为开发者提供原生二维码识别能力。</p> <h4 id="_1-1-功能流程-3"><a href="#_1-1-功能流程-3" aria-hidden="true" class="header-anchor">#</a> 1.1 功能流程</h4> <p>引入JS-SDK，直接调用即可</p> <h4 id="_1-2-准入条件-4"><a href="#_1-2-准入条件-4" aria-hidden="true" class="header-anchor">#</a> 1.2 准入条件</h4> <p>无</p> <h3 id="接入指引-4"><a href="#接入指引-4" aria-hidden="true" class="header-anchor">#</a> 接入指引</h3> <h4 id="_2-1-开发准备-4"><a href="#_2-1-开发准备-4" aria-hidden="true" class="header-anchor">#</a> 2.1 开发准备</h4> <h4 id="cdn引入-3"><a href="#cdn引入-3" aria-hidden="true" class="header-anchor">#</a> CDN引入</h4> <p>通过 <a href="https://unpkg.com/blockcity-js-sdk/" target="_blank" rel="noopener noreferrer">unpkg.com/blockcity-js-sdk<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 可以看到 Blockcity JS-SDK 最新版本的资源，也可以切换版本选择需要的资源，在页面上引入 js 文件即可开始使用：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;//unpkg.com/blockcity-js-sdk/dist/blockcity-js-sdk.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h4 id="npm安装-3"><a href="#npm安装-3" aria-hidden="true" class="header-anchor">#</a> NPM安装</h4> <p>推荐使用 npm 来安装，享受生态圈和工具带来的便利，更好地和 webpack 配合使用。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> blockcity-js-sdk -save
</code></pre></div><p>npm使用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> BlockCity <span class="token keyword">from</span> <span class="token string">'blockcity-js-sdk'</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-功能接入-2"><a href="#_2-2-功能接入-2" aria-hidden="true" class="header-anchor">#</a> 2.2 功能接入</h4> <p>唤起二维码扫一扫。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>BlockCity<span class="token punctuation">.</span><span class="token function">qrScan</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p><font size="2">小应用需要先引入Blockcity JS-SDK</font></p></blockquote> <h2 id="自定义分享"><a href="#自定义分享" aria-hidden="true" class="header-anchor">#</a> 自定义分享</h2> <h3 id="功能介绍-5"><a href="#功能介绍-5" aria-hidden="true" class="header-anchor">#</a> 功能介绍</h3> <p>为开发者提供自定义内容分享的能力。</p> <h4 id="_1-1-功能流程-4"><a href="#_1-1-功能流程-4" aria-hidden="true" class="header-anchor">#</a> 1.1 功能流程</h4> <p>引入JS-SDK，直接调用即可</p> <h4 id="_1-2-准入条件-5"><a href="#_1-2-准入条件-5" aria-hidden="true" class="header-anchor">#</a> 1.2 准入条件</h4> <p>无</p> <h3 id="接入指引-5"><a href="#接入指引-5" aria-hidden="true" class="header-anchor">#</a> 接入指引</h3> <h4 id="_2-1-开发准备-5"><a href="#_2-1-开发准备-5" aria-hidden="true" class="header-anchor">#</a> 2.1 开发准备</h4> <h4 id="cdn引入-4"><a href="#cdn引入-4" aria-hidden="true" class="header-anchor">#</a> CDN引入</h4> <p>通过 <a href="https://unpkg.com/blockcity-js-sdk/" target="_blank" rel="noopener noreferrer">unpkg.com/blockcity-js-sdk<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 可以看到 Blockcity JS-SDK 最新版本的资源，也可以切换版本选择需要的资源，在页面上引入 js 文件即可开始使用：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;//unpkg.com/blockcity-js-sdk/dist/blockcity-js-sdk.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h4 id="npm安装-4"><a href="#npm安装-4" aria-hidden="true" class="header-anchor">#</a> NPM安装</h4> <p>推荐使用 npm 来安装，享受生态圈和工具带来的便利，更好地和 webpack 配合使用。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> blockcity-js-sdk -save
</code></pre></div><p>npm使用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> BlockCity <span class="token keyword">from</span> <span class="token string">'blockcity-js-sdk'</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-功能接入-3"><a href="#_2-2-功能接入-3" aria-hidden="true" class="header-anchor">#</a> 2.2 功能接入</h4> <p>配置分享标题、描述、缩略图、URL。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>BlockCity<span class="token punctuation">.</span><span class="token function">shareConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    shareDes<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    url<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    thumbUrl<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    success<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'配置成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    fail<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'配置失败：'</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p><font size="2">小应用需要先引入Blockcity JS-SDK</font></p></blockquote></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/gxchain/blockcity-docs/edit/master/docs/en/developer/capacity.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">9/21/2018, 12:07:08 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blockcity/en/developer/release.html" class="prev">
          小应用提交
        </a></span> <span class="next"><a href="/blockcity/en/developer/api.html">
          API列表
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/blockcity/assets/js/app.dd063d02.js" defer></script><script src="/blockcity/assets/js/16.682216e4.js" defer></script>
  </body>
</html>
